<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Extend Product Template form view with SaaS fields -->
    <record id="product_template_form_inherit_saas" model="ir.ui.view">
        <field name="name">product.template.form.saas</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='general_information']" position="after">
                <page string="SaaS Configuration" name="saas_config"
                      invisible="not is_saas_plan and not is_saas_addon">
                    <group>
                        <group string="SaaS Settings">
                            <field name="is_saas_plan"/>
                            <field name="is_saas_addon"/>
                            <field name="saas_plan_id" invisible="not is_saas_plan"/>
                        </group>
                        <group string="Plan Details" invisible="not saas_plan_id">
                            <field name="plan_cpu"/>
                            <field name="plan_ram"/>
                            <field name="plan_storage_db"/>
                            <field name="plan_storage_file"/>
                            <field name="plan_users"/>
                            <field name="plan_instances"/>
                            <field name="plan_support_level"/>
                        </group>
                    </group>
                    <group string="Add-on Configuration" invisible="not is_saas_addon">
                        <field name="addon_type"/>
                        <field name="addon_quantity"/>
                        <field name="addon_unit"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Extend Product Template list view with SaaS indicator -->
    <record id="product_template_tree_inherit_saas" model="ir.ui.view">
        <field name="name">product.template.tree.saas</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='categ_id']" position="after">
                <field name="is_saas_plan" optional="hide"/>
                <field name="saas_plan_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <!-- Search filter for SaaS products -->
    <record id="product_template_search_inherit_saas" model="ir.ui.view">
        <field name="name">product.template.search.saas</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_search_view"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='services']" position="after">
                <separator/>
                <filter name="saas_plans" string="SaaS Plans"
                        domain="[('is_saas_plan', '=', True)]"/>
                <filter name="saas_addons" string="SaaS Add-ons"
                        domain="[('is_saas_addon', '=', True)]"/>
            </xpath>
        </field>
    </record>

</odoo>
